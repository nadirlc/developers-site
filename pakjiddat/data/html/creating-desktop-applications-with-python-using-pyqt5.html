<h3>Introduction</h3>

<p><a href='https://pypi.org/project/PyQt5/'>PyQt5</a> is a Python package that provides a wrapper for accessing the <a href='https://en.wikipedia.org/wiki/Qt_(software)'>Qt framework libraries</a>. Qt is a cross platform widget toolkit that allows creating graphical user interfaces. It supports Windows, Android, Linux and Mac. Several options exist for developing GUI applications using Python. For example <a href='https://en.wikipedia.org/wiki/PySide'>Pyside</a>, <a href='https://en.wikipedia.org/wiki/Tkinter'>TKinter</a>, <a href='https://en.wikipedia.org/wiki/PyGTK'>PyGTK</a> and <a href='https://en.wikipedia.org/wiki/Kivy_(framework)'>Kivy</a> are Python packages for creating GUI applications</p>

<p>The obvious benefit of GUI applications is that they allow the data to remain on the local computer. Also the GUI application is always available since it does not depend on internet connectivity. The drawback of GUI applications is that they are not as easy to access as Web based applications. For instance a GUI application needs to be installed on each computer where it is to run.</p>

<p><a href='https://packages.debian.org/stretch/qttools5-dev-tools'>Qt 5 Developments Tools</a> is a package that provides tools for the Qt5 framework. It includes the Qt5 Desginer which is a graphical designer for Qt5 applications.</p>

<h3>Installation</h3>
<p>Both the PyQt5 framework and PyQt5 Tools may be installed within a Python virtual environment. For example the command: <b>virtualenv path-to-project</b> will create a folder with standard Python libraries and binaries. This folder works as an isolated environment within which Python applications can be developed.</p>

<p>The benefit of using virtual environments is that they allow packages to be installed independently of other virtual environments or the system wide packages. Once a virtual environment has been created, it needs to activated using the command: <b>source bin/activate</b>. This will import the necessary environment.</p>

<p>To install the PyQt5 package, we need to run the command: <b>pip install PyQt5</b>. The PyQt5 tools package may be installed with the command: <b>pip install qttools5-dev-tools</b>. To test if the PyQt5 package has been successfully installed, enter the command: <b>import PyQt5</b> from the Python shell. If the command does not give errors, then the PyQt5 has been successfully installed</p>

<h3>Creating PyQt5 applications</h3>
<p>Python GUI applications are run in the same way as command line applications. The main difference is that instead of output being shown on the console, a graphical window pops up.</p>

<p>Python applications written using the PyQt5 framework all have the same basic structure. The main steps in writing a PyQt5 application are:</p>

<div>
<ul>
  <li>Import the <b>QtWidgets</b> class using: <p><pre><b>from PyQt5 import QtWidgets</b></pre></p></li>
  <li>Create an instance of the <b>QMainWindow</b> class using: <p><pre><b>app = QtWidgets.QApplication(sys.argv)</b></pre></p><p>Command line arguments are passed to the constructor</p></li>
  <li>Create an instance of the <b>QMainWindow</b> class using: <p><pre><b>MainWindow = QtWidgets.QMainWindow()</b></pre></p><p>This is the actual user interface class</p></li>
<li>Create an instance of the <b>Ui_MainWindow</b> class using: <p><pre><b>ui = Ui_MainWindow()</b></pre></p><p>This class is used to setup the user interface class created in the previous step. This class is generated by the <a href="#using-the-qt-designer">pyuic5 tool</a>. The <b>pyuic tool</b> is used to generate python code from the user interface class created by the Qt Designer. The code: <b>ui.setupUi(MainWindow)</b> is used to setup the MainWindow class</p></li>
<li>The next step is to create an instance of your own class. For example: <b>Ui_Manager</b>. This class is used to setup custom event handlers. The constructor of this class may take the ui object as parameter.</li>
<li>The next step is to display the window using: <b>MainWindow.show()</b>. This code blocks until the user closes the application.</li>
<li>The final step is to call: <b>sys.exit(app.exec_())</b>. This will end the application</li>
</ul>
</div>

<p>The GUI related code is usually auto generated using the Qt Desginer and pyuic5. We need to keep our custom code such as event handling code separate from the auto generated GUI code. Otherwise the custom code can get overwritten. The benefit of organizing the code in the way described above is that it separates the GUI related code from the code that implements the application logic. This allows the GUI to be managed using the Qt Desginer, without having to worry about the Qt Desginer overwriting the custom code. The following code shows the <b>"main"</b> function of a typical PyQt5 application:</p>

<pre><b>
if __name__ == "__main__":    
    app        = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui         = Ui_MainWindow()
    ui.setupUi(MainWindow)
    
    ui_manager = Ui_Manager()
    ui_manager.initialize_ui(ui);
    MainWindow.show()
    sys.exit(app.exec_())
</b></pre>

<p>See the source code for the <a href="https://github.com/nadirlc/islam-companion-desktop-reader">Islam Companion Desktop Reader</a> application on Git Hub for an example of a simple PyQt5 application.</p>

<h3>Using the Qt Designer</h3>
<p>The Qt Designer allows generating user interface for Qt5 applications. It allows user interfaces to be created by dragging and dropping widgets. It supports several widgets such as <b>ComboBoxes, Lists, Tables, Buttons, Labels</b> and more. It supports four types of layouts which are <b>Horizontal Layout, Vertical Layout, Grid Layout and Form Layout</b>. These layouts allow widgets to be arranged correctly.</p>

<p>Each layout in the Qt Designer is saved in XML format as a separate file with <b>.ui</b> extension. The PyQt5 framework is a wrapper for the Qt5 Framework libraries which are written in C++. The PyQt5 framework provides classes in Python for creating desktop applications. It provides classes for widgets. For example the <b>QApplication</b> class implements the main window class. Classes such as <b>QLabel</b> and <b>QPushButton</b> implement labels and buttons.</p>

<p>Using Python code for arranging widgets can be difficult, since a preview of the user interface is not immediately available. Fortunately the PyQt5 framework contains a tool called <b>pyuic5</b> which allows converting the <b>.ui</b> files of the Qt Designer to Python code.</p>

<p>For example the command: <b>bin/pyuic5 -x -o MainWindow.py MainWindow.ui</b> will generate the Python file MainWindow.py from the Qt Designer file: MainWindow.ui. The Python file can then be run using the command: <b>python MainWindow.py</b>. This should run the GUI application. The application should look exactly like the preview in the Qt Designer.</p>

<h3>Generating executable files using pyqtdeploy</h3>
<p><a href='https://www.riverbankcomputing.com/software/pyqtdeploy/intro'>pyqtdeploy</a> is a tool that allows deploying PyQt applications. It supports deploying applications to desktop platforms and mobile platforms. It supports Linux, Windows, MacOs and Android. pyqtdeploy creates a standalone binary file that can be run on the target platform.</p>

<p>pyqtdeploy can be installed as a Python package using the command: <b>pip install pyqtdeploy</b>. It requires the PyQt5 and Python 3.5 and later.</p>

<p>A useful way to learn about pyqtdeploy is to deploy the <a href='https://www.riverbankcomputing.com/static/Docs/pyqtdeploy/demo.html'>demo application</a> that is packaged with pyqtdeploy. The demo application is a simple application written using PyQt5 and Python. The documentation for the demo application describes how to build the application on the target platform. </p>

<p>Generating a standalone binary file using pyqtdeploy requires the following steps:</p>
<ol>
  <li><p>Identify the PyQt modules and other third party components that are required by the application. These components are specified in the <b>sysroot.json</b> file. The sysroot.json file that is provided with the demo application is a good starting point.</p>
  <p>The systemroot contains the Python libraries and third part components required by the application. The document <a href='https://www.riverbankcomputing.com/static/Docs/pyqtdeploy/sysroot.html#ref-building-a-sysroot'>Building a System Root Directory</a> describes how to build a sysroot. Building a sysroot can take several hours depending on the components selected. The system root is then built using the command: <b>pyqtdeploy-sysroot  --sysroot sysroot-linux-64/ --source-dir lib --verbose  sysroot.json</b>. The <b>pyqtdeploy-sysroot</b> command is part of the pyqtdeploy package.</p>
  <p>Building a sysroot causes the components specified in sysroot.json to be compiled. Usually qt5, python, sip and pyqt5 are listed in sysroot.json. Compiling qt5 requires certain packages. The article <a href='https://wiki.qt.io/Building_Qt_5_from_Git'>Building Qt 5 from Git</a> describes how to install the dependency packages that are required for building qt5 from source. For example on Ubuntu the dependencies may be installed with the command: <b>sudo apt-get build-dep qt5-default</b>. Note that this command requires source entries in the <b>/etc/apt/sources.list</b> file. Depending on which qt5 features are needed, other dependency packages may need to be installed.</p>
  </li>
  <li>The next step is to create a project file that identifies the application source code and all the components used by the application. The project file has a <b>.pdy</b> file extension. It can be created using the <b>pyqtdeploy</b> command. This command opens a graphical application that allows generating the project file. For example use the command: <b>pyqtdeploy pyqt-demo.pdy</b> to edit the project file for the demo application. The document <a href='https://www.riverbankcomputing.com/static/Docs/pyqtdeploy/pyqtdeploy.html#ref-creating-a-project'>Creating a pyqtdeploy Project</a> describes how to create a pyqtdeploy project.</li>
  <li>The next step is to freeze the Python modules and generate a <b>.pro</b> file for <b>qmake</b>. This can be done using the command: <b>pyqtdeploy-build --sysroot sysroot-linux-64/  --verbose pyqt-demo.pdy</b>. The article <a href='https://www.riverbankcomputing.com/static/Docs/pyqtdeploy/building.html#ref-building-an-application'>Building the Application</a> describes how to do generate the <b>.pro</b> file.</li>
  <li>The next step is to generate the <b>MakeFile</b> using the qmake command. This can be done using the command: <b>[path-to-qmake] pyqt-demo.pro</b>. This command should be run from the target build directory which was generated during the previous step. The <b>path-to-qmake</b> is the absolute path to the qmake binary file within the sysroot. Once the MakeFile has been generated, the next step is to generate the executable file using the command: <b>make</b>.</li>
</ol>